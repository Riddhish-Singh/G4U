<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>G4U ‚Ä¢ Goods For You ‚Äî Pro</title>
  <meta name="description" content="G4U Enhanced SPA: cart, wishlist, compare, reviews, pagination, filters, currency toggle, dark mode, PWA, and more." />
  <style>
    :root{
      --brand:#ff6600; --brand-2:#ff994d;
      --bg:#f6f7fb; --surface:#ffffff; --muted:#6b7280; --text:#0b1220; --ring:rgba(255,102,0,.45);
      --ok:#10b981; --warn:#ef4444; --info:#2563eb;
    }
    [data-theme="dark"]{ --bg:#0b0e13; --surface:#121720; --muted:#a3a7b3; --text:#e7e9ef; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:var(--bg);color:var(--text)}
    img{max-width:100%;display:block}
    a{color:inherit;text-decoration:none}
    .container{max-width:1240px;margin:0 auto;padding:0 18px}

    /* Topbar */
    .top{position:sticky;top:0;z-index:60;background:var(--surface);border-bottom:1px solid rgba(0,0,0,.06);box-shadow:0 10px 30px rgba(0,0,0,.05)}
    .top-inner{height:64px;display:flex;align-items:center;gap:12px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;letter-spacing:.2px}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;display:grid;place-items:center;font-weight:900}
    .search{flex:1;display:flex;align-items:center;gap:8px;background:var(--bg);border:1px solid rgba(0,0,0,.08);padding:10px 12px;border-radius:12px}
    .search input{flex:1;border:0;outline:none;background:transparent;color:var(--text)}
    .actions{display:flex;align-items:center;gap:8px}
    .btn{border:0;border-radius:12px;padding:10px 12px;font-weight:700;cursor:pointer}
    .btn.primary{background:var(--brand);color:#fff}
    .btn.ghost{background:transparent;border:1px solid rgba(0,0,0,.12)}
    .iconbtn{position:relative;min-width:42px;height:42px;display:flex;align-items:center;gap:8px;padding:0 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:var(--surface);cursor:pointer}
    .badge{position:absolute;top:-6px;right:-6px;background:var(--brand);color:#fff;border-radius:999px;font-size:12px;line-height:18px;padding:0 6px;font-weight:800}
    .select{border:1px solid rgba(0,0,0,.12);background:var(--surface);border-radius:10px;padding:8px 10px}

    /* Announcement */
    .ann{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;padding:10px;border-bottom:1px solid rgba(0,0,0,.1);text-align:center;font-weight:700}

    /* Hero */
    .hero{padding:28px 0}
    .hero-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:16px}
    .panel{background:var(--surface);border:1px solid rgba(0,0,0,.06);border-radius:18px;padding:18px}
    .panel h1{margin:6px 0 8px;font-size:34px}
    .kicker{color:var(--muted)}
    .cta{display:flex;gap:10px;margin-top:12px}

    /* Category chips */
    .chip{border:1px solid rgba(0,0,0,.12);background:var(--surface);padding:8px 12px;border-radius:999px;cursor:pointer}
    .chip.active{outline:3px solid var(--ring);border-color:transparent}

    /* Section head */
    .head{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:10px;margin:6px 0 12px}

    /* Product grid */
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
    .card{background:var(--surface);border:1px solid rgba(0,0,0,.06);border-radius:16px;overflow:hidden;display:flex;flex-direction:column;transition:transform .15s ease}
    .card:hover{transform:translateY(-2px)}
    .thumb{position:relative;height:190px}
    .thumb img{height:100%;width:100%;object-fit:cover}
    .badge-pill{position:absolute;left:10px;top:10px;background:#111827;color:#fff;padding:6px 10px;border-radius:999px;font-size:12px}
    [data-theme="dark"] .badge-pill{background:#1f2937}
    .body{padding:12px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:800}
    .muted{color:var(--muted)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .price{font-weight:900}
    .pill{border-radius:8px;padding:6px 8px;border:1px solid rgba(0,0,0,.12);cursor:pointer;background:transparent}

    /* Pagination */
    .pagination{display:flex;gap:8px;justify-content:center;margin:18px 0}

    /* Drawers / Modals */
    .drawer{position:fixed;top:0;right:0;bottom:0;width:400px;max-width:100%;background:var(--surface);transform:translateX(110%);transition:transform .28s ease;border-left:1px solid rgba(0,0,0,.1);z-index:70;display:flex;flex-direction:column}
    .drawer.open{transform:translateX(0)}
    .drawer header{padding:14px;border-bottom:1px solid rgba(0,0,0,.08);display:flex;align-items:center;justify-content:space-between}
    .drawer .items{flex:1;overflow:auto;padding:14px;display:flex;flex-direction:column;gap:10px}
    .cart-item{display:grid;grid-template-columns:64px 1fr auto;gap:10px;align-items:center;background:var(--bg);border-radius:12px;padding:8px}
    .qty{display:flex;align-items:center;gap:8px}
    .qty button{width:28px;height:28px;border-radius:8px;border:1px solid rgba(0,0,0,.12);background:var(--surface);cursor:pointer}
    .drawer footer{border-top:1px solid rgba(0,0,0,.08);padding:12px}
    .summary{display:grid;grid-template-columns:1fr auto;gap:8px;margin-bottom:10px}
    .progress{height:8px;border-radius:8px;background:rgba(0,0,0,.08);overflow:hidden}
    .progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--brand),var(--brand-2));width:0%}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:80;padding:12px}
    .modal.open{display:flex}
    .modal .box{background:var(--surface);border-radius:16px;max-width:900px;width:100%;display:grid;grid-template-columns:1fr 1fr;overflow:hidden}
    .box .img{background:#0f172a}
    .box .img img{height:100%;width:100%;object-fit:cover}
    .box .info{padding:16px;display:flex;flex-direction:column;gap:10px}

    /* Wishlist & Compare */
    .strip{display:flex;gap:10px;overflow:auto;padding-bottom:6px}
    .mini{min-width:140px;background:var(--surface);border:1px solid rgba(0,0,0,.08);border-radius:12px;overflow:hidden}

    /* Toast & Help */
    .toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%);padding:10px 14px;border-radius:12px;background:var(--surface);border:1px solid rgba(0,0,0,.08);box-shadow:0 8px 30px rgba(0,0,0,.12);display:none;z-index:90}
    .toast.show{display:block}
    .help{position:fixed;right:16px;bottom:16px}

    /* Checkout */
    .checkout{display:none}
    .checkout.active{display:block}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .field{display:flex;flex-direction:column;gap:6px}
    .input{padding:10px 12px;border:1px solid rgba(0,0,0,.12);border-radius:10px;background:var(--surface);color:var(--text)}

    /* Responsive */
    @media (max-width: 1000px){ .grid{grid-template-columns:repeat(2,1fr)} .hero-grid{grid-template-columns:1fr} .modal .box{grid-template-columns:1fr} }
    @media (max-width: 560px){ .grid{grid-template-columns:1fr} .search{display:none} }
  </style>
</head>
<body>
  <div class="ann">Free shipping over ‚Çπ1,999 ‚Ä¢ Use code <b>G4U10</b> for 10% off at checkout</div>
  <header class="top">
    <div class="container top-inner">
      <a class="brand" href="#home" aria-label="G4U home"><span class="logo">G4U</span><span>Goods For You</span></a>
      <label class="search" aria-label="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input id="q" type="search" placeholder="Search clothing, beauty, spare parts‚Ä¶ ( / )" />
      </label>
      <div class="actions">
        <select id="currency" class="select" title="Currency">
          <option value="INR">INR ‚Çπ</option>
          <option value="USD">USD $</option>
        </select>
        <button class="iconbtn" id="themeBtn" title="Toggle theme">üåô</button>
        <button class="iconbtn" id="wishBtn" title="Open wishlist">ü§ç<span class="badge" id="wishBadge">0</span></button>
        <button class="iconbtn" id="compareBtn" title="Compare items">üìä<span class="badge" id="compareBadge">0</span></button>
        <button class="iconbtn" id="cartBtn" title="Open cart">üõí Cart <span class="badge" id="cartBadge">0</span></button>
      </div>
    </div>
  </header>

  <main class="container" id="home">
    <!-- Hero -->
    <section class="hero">
      <div class="hero-grid">
        <div class="panel">
          <div class="kicker">All‚Äëin‚Äëone marketplace</div>
          <h1>Everything you need. <span style="color:var(--brand)">All in one place.</span></h1>
          <p class="kicker">Shop across <b>Clothing</b>, <b>Beauty & Home D√©cor</b>, and <b>Spare Parts</b>. Smooth cart, wishlist, compare, reviews ‚Äî all baked in.</p>
          <div class="cta">
            <button class="btn primary" data-cat="clothing">Shop Clothing</button>
            <button class="btn ghost" data-cat="beauty">Explore Beauty & D√©cor</button>
            <button class="btn ghost" data-cat="spareparts">Spare Parts</button>
          </div>
        </div>
        <div class="panel"><img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?q=80&w=1400&auto=format&fit=crop" alt="Showcase" style="border-radius:12px;height:100%;object-fit:cover"/></div>
      </div>
    </section>

    <!-- Controls -->
    <section class="head">
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="chip active" data-filter="all">All</button>
        <button class="chip" data-filter="clothing">Clothing</button>
        <button class="chip" data-filter="beauty">Beauty & D√©cor</button>
        <button class="chip" data-filter="spareparts">Spare Parts</button>
        <span class="chip" style="cursor:default">Min ‚Çπ<span id="minVal">0</span><input id="minRange" type="range" min="0" max="5000" step="100" value="0" style="vertical-align:middle;margin-left:8px"></span>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <label class="muted">Sort</label>
        <select id="sort" class="select">
          <option value="pop">Popularity</option>
          <option value="plh">Price: Low ‚Üí High</option>
          <option value="phl">Price: High ‚Üí Low</option>
          <option value="rate">Rating</option>
        </select>
        <button class="pill" id="reset">Reset</button>
      </div>
    </section>

    <!-- Product grid -->
    <section>
      <div class="grid" id="grid"></div>
      <div class="pagination" id="pager"></div>
    </section>

    <!-- Recently viewed -->
    <section style="margin:18px 0">
      <h3>Recently viewed</h3>
      <div class="strip" id="recent"></div>
    </section>

    <!-- Checkout (mock) -->
    <section id="checkout" class="checkout">
      <h2>Checkout</h2>
      <div class="grid2">
        <div class="panel">
          <h3>Shipping</h3>
          <div class="field"><label>Full name</label><input class="input" id="fullName" placeholder="Your name"></div>
          <div class="field"><label>Address</label><input class="input" id="address" placeholder="Street, City, PIN"></div>
          <div class="grid2">
            <div class="field"><label>Phone</label><input class="input" id="phone" placeholder="10‚Äëdigit"></div>
            <div class="field"><label>Email</label><input class="input" id="email" placeholder="you@example.com"></div>
          </div>
        </div>
        <div class="panel">
          <h3>Order summary</h3>
          <div id="coItems"></div>
          <div class="summary">
            <div>Subtotal</div><div id="coSub">‚Çπ0</div>
            <div>Shipping</div><div id="coShip">‚Çπ0</div>
            <div>Discount</div><div id="coDisc">-‚Çπ0</div>
            <div><strong>Total</strong></div><div id="coTot"><strong>‚Çπ0</strong></div>
          </div>
          <div class="field"><label>Coupon</label><input class="input" id="coupon" placeholder="G4U10"></div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn primary" id="pay">Pay Now (Demo)</button>
            <button class="btn ghost" id="invoice">Print Invoice</button>
          </div>
        </div>
      </div>
    </section>

    <footer style="text-align:center;color:var(--muted);margin:36px 0 68px">¬© <span id="year"></span> G4U ‚Ä¢ Built for demo ‚Ä¢ Shortcuts: <b>/</b> search, <b>c</b> cart, <b>w</b> wishlist, <b>?</b> help</footer>
  </main>

  <!-- Drawers -->
  <aside class="drawer" id="cart" aria-label="Cart">
    <header><strong>Your Cart</strong><button class="pill" id="cartClose">Close</button></header>
    <div class="items" id="cartItems"></div>
    <footer>
      <div class="summary">
        <div>Subtotal</div><div id="sub">‚Çπ0</div>
        <div>Shipping</div><div id="ship">‚Çπ0</div>
        <div><strong>Total</strong></div><div id="tot"><strong>‚Çπ0</strong></div>
      </div>
      <div class="kicker" id="freeMsg"></div>
      <div class="progress"><span id="shipProg"></span></div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="pill" id="clear">Clear</button>
        <a class="btn primary" href="#checkout" id="toCheckout">Checkout</a>
        <button class="pill" id="exportCart">Export</button>
        <button class="pill" id="importCart">Import</button>
      </div>
    </footer>
  </aside>

  <aside class="drawer" id="wishlist" aria-label="Wishlist">
    <header><strong>Wishlist</strong><button class="pill" id="wishClose">Close</button></header>
    <div class="items" id="wishItems"></div>
  </aside>

  <!-- Modals -->
  <div class="modal" id="modal">
    <div class="box">
      <div class="img"><img id="mImg" alt="Product"></div>
      <div class="info">
        <h3 id="mTitle">Product</h3>
        <div class="muted" id="mCat">Category</div>
        <div class="price" id="mPrice">‚Çπ0</div>
        <div id="mStock" class="muted"></div>
        <p id="mDesc" class="muted"></p>
        <div id="variantWrap" style="display:none;gap:8px;align-items:center">
          <label>Size</label>
          <select id="mSize" class="select"><option>S</option><option>M</option><option>L</option><option>XL</option></select>
          <label>Color</label>
          <select id="mColor" class="select"><option>Black</option><option>White</option><option>Grey</option></select>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <button class="btn primary" id="mAdd">Add to Cart</button>
          <button class="pill" id="mWish">‚ô° Wishlist</button>
          <button class="pill" id="mCompare">‚áÑ Compare</button>
          <button class="pill" id="mClose">Close</button>
        </div>
        <hr style="border:none;border-top:1px solid rgba(0,0,0,.08)">
        <div>
          <strong>Reviews</strong>
          <div id="reviews" class="muted"></div>
          <div style="display:flex;gap:6px;margin-top:6px">
            <input id="revText" class="input" placeholder="Write a review (local)"/>
            <button id="revAdd" class="pill">Post</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="compareModal">
    <div class="box" style="grid-template-columns:1fr">
      <div class="info">
        <h3>Compare</h3>
        <div id="compareTable" style="overflow:auto"></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
          <button class="pill" id="compareClear">Clear</button>
          <button class="pill" id="compareClose">Close</button>
        </div>
      </div>
    </div>
  </div>

  <button class="btn primary help" id="help">?</button>
  <div class="toast" id="toast">Toast</div>

  <script>
    // ===== Data =============================================================
    const INRfmt = n => `‚Çπ${n.toLocaleString('en-IN')}`;
    const USDfmt = n => `$${n.toFixed(2)}`;
    const CX = {
      FREE_SHIP: 1999,
      USD_RATE: 0.0122 // approx; static for demo
    };
    const PRODUCTS = [
      // clothing
      {id:'c1', title:'Oversized Cotton Tee', price:699,  cat:'clothing', rating:4.6, stock:32, img:'https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=1200&auto=format&fit=crop', desc:'Breathable 180 GSM cotton. Unisex fit. Perfect for everyday.'},
      {id:'c2', title:'Denim Jeans ‚Äì Indigo',  price:1799, cat:'clothing', rating:4.4, stock:9,  img:'https://images.unsplash.com/photo-1490481651871-ab68de25d43d?q=80&w=1200&auto=format&fit=crop',  desc:'Tapered fit with stretch. Durable stitching.'},
      {id:'c3', title:'Athleisure Hoodie',     price:1499, cat:'clothing', rating:4.7, stock:0,  img:'https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1200&auto=format&fit=crop',  desc:'Soft fleece lining, kangaroo pocket.'},
      {id:'c4', title:'Sneakers ‚Äì White Low',  price:2199, cat:'clothing', rating:4.5, stock:21, img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=1200&auto=format&fit=crop',  desc:'Classic low-tops, everyday comfort.'},
      // beauty
      {id:'b1', title:'Glow Serum 30ml',       price:999,  cat:'beauty',   rating:4.3, stock:25, img:'https://images.unsplash.com/photo-1611930022073-b7a4ba5fcccd?q=80&w=1200&auto=format&fit=crop', desc:'Vitamin C + niacinamide brightening serum.'},
      {id:'b2', title:'Matte Lip Color',       price:549,  cat:'beauty',   rating:4.1, stock:50, img:'https://images.unsplash.com/photo-1582092722543-22683c45f04f?q=80&w=1200&auto=format&fit=crop', desc:'Long‚Äëwear matte finish.'},
      {id:'b3', title:'Aromatic Soy Candle',   price:799,  cat:'beauty',   rating:4.8, stock:8,  img:'https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop', desc:'Vanilla cedar scent. 40h burn.'},
      {id:'b4', title:'Wall Art ‚Äì Abstract',   price:1299, cat:'beauty',   rating:4.4, stock:16, img:'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1200&auto=format&fit=crop', desc:'Printed canvas, 60√ó40cm.'},
      // spare
      {id:'s1', title:'Bike Brake Pads (Set)', price:899,  cat:'spareparts',rating:4.5, stock:44, img:'https://images.unsplash.com/photo-1600709363050-b8eb83f54d58?q=80&w=1200&auto=format&fit=crop', desc:'All-weather grip, low noise.'},
      {id:'s2', title:'Spark Plug ‚Äì A7',       price:349,  cat:'spareparts',rating:4.2, stock:120,img:'https://images.unsplash.com/photo-1543264755-bba170f6a9a3?q=80&w=1200&auto=format&fit=crop', desc:'Optimized ignition, fits common models.'},
      {id:'s3', title:'Tool Kit 46‚Äëin‚Äë1',      price:1499, cat:'spareparts',rating:4.6, stock:13, img:'https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?q=80&w=1200&auto=format&fit=crop', desc:'Sockets, bits, ratchet. Portable case.'},
      {id:'s4', title:'Air Filter ‚Äì Universal',price:649,  cat:'spareparts',rating:4.0, stock:0,  img:'https://images.unsplash.com/photo-1581090464777-f3220bbe1b8b?q=80&w=1200&auto=format&fit=crop', desc:'Washable, improves airflow.'},
    ];

    // ===== State ============================================================
    const state = {
      theme: localStorage.getItem('g4u_theme') || 'light',
      currency: localStorage.getItem('g4u_ccy') || 'INR',
      cart: JSON.parse(localStorage.getItem('g4u_cart')||'[]'),
      wish: JSON.parse(localStorage.getItem('g4u_wish')||'[]'),
      compare: JSON.parse(localStorage.getItem('g4u_cmp')||'[]'),
      recent: JSON.parse(localStorage.getItem('g4u_recent')||'[]'),
      reviews: JSON.parse(localStorage.getItem('g4u_reviews')||'{}'),
      filter:'all', sort:'pop', min:0, q:'', page:1, per:8
    };

    // ===== Helpers ==========================================================
    const el = id => document.getElementById(id);
    const fmt = (n)=> state.currency==='USD'? USDfmt(n*CX.USD_RATE) : INRfmt(n);
    const save = () => {
      localStorage.setItem('g4u_cart',JSON.stringify(state.cart));
      localStorage.setItem('g4u_wish',JSON.stringify(state.wish));
      localStorage.setItem('g4u_cmp', JSON.stringify(state.compare));
      localStorage.setItem('g4u_recent', JSON.stringify(state.recent.slice(0,12)));
      localStorage.setItem('g4u_reviews', JSON.stringify(state.reviews));
    };
    const toast = (m)=>{ const t=el('toast'); t.textContent=m; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1200); };

    // ===== Render: Products, Pager =========================================
    function filtered(){
      const q = state.q.toLowerCase();
      let arr = PRODUCTS.filter(p => (state.filter==='all'||p.cat===state.filter) && p.price>=state.min && (p.title+" "+p.desc).toLowerCase().includes(q));
      if(state.sort==='plh') arr.sort((a,b)=>a.price-b.price);
      if(state.sort==='phl') arr.sort((a,b)=>b.price-a.price);
      if(state.sort==='rate') arr.sort((a,b)=>b.rating-a.rating);
      // pop default keeps original order
      return arr;
    }
    function renderProducts(){
      const items = filtered();
      const start = (state.page-1)*state.per;
      const pageItems = items.slice(start,start+state.per);
      el('grid').innerHTML = pageItems.map(p=>cardHTML(p)).join('') || '<div class="muted">No products found.</div>';
      renderPager(items.length);
    }
    function cardHTML(p){
      const low = p.stock>0 && p.stock<10 ? `<span class="badge-pill" style="background:var(--warn)">Only ${p.stock} left</span>`:'';
      const oos = p.stock===0? `<span class="badge-pill" style="background:#111">Only 9 left</span>`:'';
      return `<article class="card" data-id="${p.id}">
        <div class="thumb">
          ${low || oos}
          <img loading="lazy" src="${p.img}" alt="${p.title}">
        </div>
        <div class="body">
          <div class="title">${p.title}</div>
          <div class="muted">${niceCat(p.cat)} ‚Ä¢ ‚≠ê ${p.rating.toFixed(1)}</div>
          <div class="row">
            <div class="price">${fmt(p.price)}</div>
            <div style="display:flex;gap:6px">
              <button class="pill quick">View</button>
              <button class="btn primary add">Add</button>
            </div>
          </div>
          <div class="row">
            <button class="pill wish">‚ô°</button>
            <button class="pill cmp">‚áÑ</button>
          </div>
        </div>
      </article>`;
    }
    function renderPager(total){
      const pages = Math.max(1, Math.ceil(total/state.per));
      state.page = Math.min(state.page, pages);
      const b = [];
      b.push(`<button class="pill pg" data-pg="prev" ${state.page===1?'disabled':''}>Prev</button>`);
      for(let i=1;i<=pages;i++) b.push(`<button class="pill pg" data-pg="${i}" ${i===state.page?'style="outline:3px solid var(--ring)"':''}>${i}</button>`);
      b.push(`<button class="pill pg" data-pg="next" ${state.page===pages?'disabled':''}>Next</button>`);
      el('pager').innerHTML = b.join('');
    }
    function niceCat(c){ return c==='beauty'?'Beauty & D√©cor': c==='spareparts'?'Spare Parts':'Clothing'; }

    // ===== Cart =============================================================
    function cartCount(){ return state.cart.reduce((a,i)=>a+i.qty,0); }
    function cartSub(){ return state.cart.reduce((a,i)=>a+i.qty*i.price,0); }
    function updateCartBadge(){ el('cartBadge').textContent = cartCount(); }
    function renderCart(){
      const list = el('cartItems');
      if(state.cart.length===0){ list.innerHTML = '<div class="muted" style="text-align:center">Cart is empty</div>'; }
      else list.innerHTML = state.cart.map(i=>`<div class="cart-item" data-id="${i.id}">
        <img src="${i.img}" alt="${i.title}" style="width:64px;height:64px;object-fit:cover;border-radius:8px">
        <div>
          <div style="font-weight:800">${i.title}</div>
          <div class="muted">${niceCat(i.cat)}</div>
          <div class="price">${fmt(i.price)}</div>
        </div>
        <div class="qty">
          <button class="dec">‚àí</button>
          <span>${i.qty}</span>
          <button class="inc">+</button>
          <button class="pill rm">‚úï</button>
        </div>
      </div>`).join('');
      const sub = cartSub();
      const ship = sub>0 && sub<CX.FREE_SHIP ? 99 : 0;
      const total = sub + ship;
      el('sub').textContent = fmt(sub);
      el('ship').textContent = fmt(ship);
      el('tot').innerHTML = `<strong>${fmt(total)}</strong>`;
      const remain = Math.max(0, CX.FREE_SHIP - sub);
      el('freeMsg').textContent = remain===0? 'You unlocked FREE shipping üéâ' : `Add ${fmt(remain)} more for free shipping`;
      const pct = Math.min(100, (sub/CX.FREE_SHIP)*100);
      el('shipProg').style.width = pct+'%';
      updateCartBadge();
    }

    function addToCart(id, qty=1){
      const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
      const ex = state.cart.find(x=>x.id===id);
      if(ex) ex.qty += qty; else state.cart.push({...p, qty});
      save(); renderCart(); toast('Added to cart');
    }

    // ===== Wishlist =========================================================
    function inWish(id){ return state.wish.includes(id); }
    function toggleWish(id){
      if(inWish(id)) state.wish = state.wish.filter(x=>x!==id); else state.wish.push(id);
      localStorage.setItem('g4u_wish', JSON.stringify(state.wish));
      renderWishlist(); updateWishBadge(); toast(inWish(id)?'Added to wishlist':'Removed from wishlist');
    }
    function updateWishBadge(){ el('wishBadge').textContent = state.wish.length; }
    function renderWishlist(){
      const list = el('wishItems');
      if(state.wish.length===0){ list.innerHTML = '<div class="muted" style="text-align:center">Wishlist is empty</div>'; return; }
      list.innerHTML = state.wish.map(id=>PRODUCTS.find(p=>p.id===id)).filter(Boolean).map(p=>`<div class="cart-item" data-id="${p.id}">
        <img src="${p.img}" style="width:64px;height:64px;object-fit:cover;border-radius:8px">
        <div><div style="font-weight:800">${p.title}</div><div class="muted">${niceCat(p.cat)}</div><div class="price">${fmt(p.price)}</div></div>
        <div class="qty"><button class="pill add">Add</button><button class="pill rm">Remove</button></div>
      </div>`).join('');
    }

    // ===== Compare ==========================================================
    function toggleCompare(id){
      if(state.compare.includes(id)) state.compare = state.compare.filter(x=>x!==id); else {
        if(state.compare.length>=3){ toast('Max 3 items to compare'); return; }
        state.compare.push(id);
      }
      localStorage.setItem('g4u_cmp', JSON.stringify(state.compare));
      el('compareBadge').textContent = state.compare.length;
    }
    function openCompare(){
      const items = state.compare.map(id=>PRODUCTS.find(p=>p.id===id)).filter(Boolean);
      if(items.length===0){ toast('Add items to compare'); return; }
      const cols = items.map(p=>`<th>${p.title}</th>`).join('');
      const row = (k, fn)=>`<tr><td class="muted">${k}</td>${items.map(fn).join('')}</tr>`;
      const html = `<table style="border-collapse:collapse;width:100%">
        <tr><th></th>${cols}</tr>
        ${row('Price', p=>`<td style="padding:8px;border-top:1px solid rgba(0,0,0,.08)">${fmt(p.price)}</td>`)}
        ${row('Rating', p=>`<td style="padding:8px;border-top:1px solid rgba(0,0,0,.08)">‚≠ê ${p.rating}</td>`)}
        ${row('Category', p=>`<td style="padding:8px;border-top:1px solid rgba(0,0,0,.08)">${niceCat(p.cat)}</td>`)}
        ${row('Stock', p=>`<td style="padding:8px;border-top:1px solid rgba(0,0,0,.08)">${p.stock}</td>`)}
      </table>`;
      el('compareTable').innerHTML = html;
      document.getElementById('compareModal').classList.add('open');
    }

    // ===== Modal / Reviews ==================================================
    function openModal(p){
      el('mImg').src=p.img; el('mTitle').textContent=p.title; el('mCat').textContent=niceCat(p.cat); el('mPrice').textContent=fmt(p.price);
      el('mDesc').textContent=p.desc; el('mStock').textContent=p.stock===0?'Out of stock': (p.stock<10?`Hurry! Only ${p.stock} left`:`In stock: ${p.stock}`);
      // variants for clothing only
      document.getElementById('variantWrap').style.display = p.cat==='clothing'? 'flex':'none';
      el('mAdd').onclick = ()=>{ addToCart(p.id,1); closeModal(); };
      el('mWish').onclick = ()=>{ toggleWish(p.id); };
      el('mCompare').onclick = ()=>{ toggleCompare(p.id); toast('Compare list updated'); };
      // reviews
      const list = state.reviews[p.id] || [];
      el('reviews').innerHTML = list.length? list.map(r=>`<div>‚Ä¢ ${r}</div>`).join('') : '<div class="muted">No reviews yet</div>';
      el('revAdd').onclick = ()=>{
        const t = el('revText').value.trim(); if(!t) return;
        state.reviews[p.id] = (state.reviews[p.id]||[]).concat(t); el('revText').value=''; save(); openModal(p); // re-render
      };
      // recently viewed
      state.recent = [p.id].concat(state.recent.filter(x=>x!==p.id)); save(); renderRecent();
      document.getElementById('modal').classList.add('open');
    }
    function closeModal(){ document.getElementById('modal').classList.remove('open'); }

    function renderRecent(){
      const bar = el('recent');
      const items = state.recent.map(id=>PRODUCTS.find(p=>p.id===id)).filter(Boolean);
      bar.innerHTML = items.map(p=>`<div class="mini" data-id="${p.id}"><img src="${p.img}" alt="${p.title}"><div style="padding:6px"><div class="title" style="font-size:12px">${p.title}</div><div class="muted" style="font-size:12px">${fmt(p.price)}</div></div></div>`).join('');
    }

    // ===== Checkout & Invoice ==============================================
    function renderCheckout(){
      const wrap = el('coItems');
      if(state.cart.length===0){ wrap.innerHTML = '<div class="muted">No items</div>'; }
      else wrap.innerHTML = state.cart.map(i=>`<div class="row"><span>${i.title} √ó ${i.qty}</span><span>${fmt(i.qty*i.price)}</span></div>`).join('');
      const sub = cartSub();
      const ship = sub>0 && sub<CX.FREE_SHIP ? 99 : 0;
      const disc = (el('coupon').value.trim().toUpperCase()==='G4U10') ? Math.round(.10*(sub+ship)) : 0;
      el('coSub').textContent = fmt(sub);
      el('coShip').textContent = fmt(ship);
      el('coDisc').textContent = '-' + fmt(disc);
      el('coTot').innerHTML = `<strong>${fmt(sub+ship-disc)}</strong>`;
    }
    function printInvoice(){
      const win = window.open('','_blank');
      const rows = state.cart.map(i=>`<tr><td>${i.title}</td><td>${i.qty}</td><td>${fmt(i.price)}</td><td>${fmt(i.qty*i.price)}</td></tr>`).join('');
      win.document.write(`<h2>G4U Invoice</h2><table border="1" cellspacing="0" cellpadding="6"><tr><th>Item</th><th>Qty</th><th>Price</th><th>Total</th></tr>${rows}</table><p>Total: ${el('coTot').innerText}</p>`);
      win.print();
    }

    // ===== Event wiring =====================================================
    // theme
    const root = document.documentElement;
    function applyTheme(){ root.setAttribute('data-theme', state.theme); el('themeBtn').textContent = state.theme==='dark'?'‚òÄÔ∏è':'üåô'; }
    el('themeBtn').addEventListener('click', ()=>{ state.theme = (state.theme==='dark'?'light':'dark'); localStorage.setItem('g4u_theme', state.theme); applyTheme(); });

    // currency
    const $ccy = el('currency'); $ccy.value = state.currency; $ccy.addEventListener('change', ()=>{ state.currency=$ccy.value; localStorage.setItem('g4u_ccy', state.currency); renderProducts(); renderCart(); renderCheckout(); renderRecent(); });

    // search
    let st; el('q').addEventListener('input', e=>{ clearTimeout(st); state.q=e.target.value; st=setTimeout(()=>{ state.page=1; renderProducts(); }, 120); });

    // controls
    document.querySelectorAll('.chip[data-filter]').forEach(ch=>ch.addEventListener('click', ()=>{ document.querySelectorAll('.chip').forEach(x=>x.classList.remove('active')); ch.classList.add('active'); state.filter=ch.dataset.filter; state.page=1; renderProducts(); }));
    const $min = el('minRange'), $minVal = el('minVal'); $min.addEventListener('input', ()=>{ state.min=+$min.value; $minVal.textContent=state.min; state.page=1; renderProducts(); });
    el('sort').addEventListener('change', e=>{ state.sort=e.target.value; renderProducts(); });
    el('reset').addEventListener('click', ()=>{ state.filter='all'; state.min=0; state.sort='pop'; state.q=''; state.page=1; document.querySelectorAll('.chip').forEach(x=>x.classList.remove('active')); document.querySelector('.chip[data-filter="all"]').classList.add('active'); $min.value=0; $minVal.textContent='0'; el('q').value=''; el('sort').value='pop'; renderProducts(); });

    // grid clicks
    el('grid').addEventListener('click', e=>{
      const card = e.target.closest('.card'); if(!card) return; const id = card.dataset.id; const p = PRODUCTS.find(x=>x.id===id);
      if(e.target.classList.contains('add')) addToCart(id);
      if(e.target.classList.contains('quick')) openModal(p);
      if(e.target.classList.contains('wish')) toggleWish(id);
      if(e.target.classList.contains('cmp')) { toggleCompare(id); toast('Compare list updated'); }
    });

    // pagination
    el('pager').addEventListener('click', e=>{
      const b = e.target.closest('.pg'); if(!b) return; const val = b.dataset.pg; const total = Math.ceil(filtered().length/state.per);
      if(val==='prev' && state.page>1) state.page--; else if(val==='next' && state.page<total) state.page++; else if(!isNaN(+val)) state.page=+val; renderProducts();
    });

    // recent clicks
    el('recent').addEventListener('click', e=>{ const mini = e.target.closest('.mini'); if(!mini) return; const p = PRODUCTS.find(x=>x.id===mini.dataset.id); if(p) openModal(p); });

    // cart drawer
    const $cart = el('cart');
    function openCart(){ $cart.classList.add('open'); renderCart(); }
    function closeCart(){ $cart.classList.remove('open'); }
    el('cartBtn').addEventListener('click', openCart);
    el('cartClose').addEventListener('click', closeCart);
    el('clear').addEventListener('click', ()=>{ state.cart=[]; save(); renderCart(); renderCheckout(); });
    el('cartItems').addEventListener('click', e=>{
      const row = e.target.closest('.cart-item'); if(!row) return; const id=row.dataset.id; const item = state.cart.find(x=>x.id===id);
      if(e.target.classList.contains('inc')) item.qty++;
      if(e.target.classList.contains('dec')) item.qty=Math.max(1,item.qty-1);
      if(e.target.classList.contains('rm')) state.cart = state.cart.filter(x=>x.id!==id);
      save(); renderCart(); renderCheckout();
    });
    el('toCheckout').addEventListener('click', ()=>{ document.getElementById('checkout').classList.add('active'); location.hash='#checkout'; closeCart(); renderCheckout(); });
    el('exportCart').addEventListener('click', ()=>{ const data = btoa(unescape(encodeURIComponent(JSON.stringify(state.cart)))); prompt('Copy your cart backup:', data); });
    el('importCart').addEventListener('click', ()=>{ const data = prompt('Paste your cart backup:'); try{ state.cart = JSON.parse(decodeURIComponent(escape(atob(data)))); save(); renderCart(); }catch(e){ alert('Invalid data'); } });

    // wishlist drawer
    const $wish = el('wishlist');
    function openWish(){ $wish.classList.add('open'); renderWishlist(); }
    function closeWish(){ $wish.classList.remove('open'); }
    el('wishBtn').addEventListener('click', openWish);
    el('wishClose').addEventListener('click', closeWish);
    el('wishItems').addEventListener('click', e=>{ const row = e.target.closest('.cart-item'); if(!row) return; const id=row.dataset.id; if(e.target.classList.contains('add')) addToCart(id); if(e.target.classList.contains('rm')){ state.wish=state.wish.filter(x=>x!==id); save(); renderWishlist(); updateWishBadge(); }});

    // compare modal
    el('compareBtn').addEventListener('click', openCompare);
    el('compareClose').addEventListener('click', ()=>document.getElementById('compareModal').classList.remove('open'));
    el('compareClear').addEventListener('click', ()=>{ state.compare=[]; localStorage.setItem('g4u_cmp','[]'); el('compareBadge').textContent='0'; document.getElementById('compareModal').classList.remove('open'); });

    // modal actions
    el('mClose').addEventListener('click', closeModal);
    document.getElementById('modal').addEventListener('click', e=>{ if(e.target.id==='modal') closeModal(); });

    // checkout actions
    el('coupon').addEventListener('input', renderCheckout);
    el('pay').addEventListener('click', ()=>{
      if(state.cart.length===0) { alert('Cart is empty'); return; }
      if(!el('fullName').value.trim()||!el('address').value.trim()) { alert('Fill shipping details'); return; }
      alert('Payment successful (demo). Order placed!');
      state.cart=[]; save(); renderCart(); renderCheckout(); location.hash='#home';
    });
    el('invoice').addEventListener('click', printInvoice);

    // hero category shortcuts
    document.querySelectorAll('.cta .btn').forEach(b=>b.addEventListener('click', ()=>{ document.querySelectorAll('.chip').forEach(x=>x.classList.remove('active')); document.querySelector(`.chip[data-filter="${b.dataset.cat}"]`)?.classList.add('active'); state.filter=b.dataset.cat; state.page=1; renderProducts(); window.scrollTo({top: document.getElementById('grid').offsetTop-80, behavior:'smooth'}); }));

    // keyboard shortcuts
    window.addEventListener('keydown', (e)=>{
      if(e.key==='/'){ e.preventDefault(); el('q').focus(); }
      if(e.key==='c') openCart();
      if(e.key==='w') openWish();
      if(e.key==='?') alert('Shortcuts: / search, c cart, w wishlist, ? help');
    });

    // PWA (service worker via Blob)
    if('serviceWorker' in navigator){
      const sw = `self.addEventListener('install',e=>{ e.waitUntil(caches.open('g4u-cache-v1').then(c=>c.addAll(['/'])) )}); self.addEventListener('fetch',e=>{ e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)))})`;
      const blob = new Blob([sw], {type:'text/javascript'});
      navigator.serviceWorker.register(URL.createObjectURL(blob));
    }

    // Init
    document.getElementById('year').textContent=new Date().getFullYear();
    document.documentElement.setAttribute('data-theme', state.theme); applyTheme();
    el('wishBadge').textContent = state.wish.length; el('compareBadge').textContent = state.compare.length; renderProducts(); renderCart(); renderWishlist(); renderRecent();
 
// ===== Live Email Validation with DNS-over-HTTPS ===============================
function validateEmailFormat(email) {
  // strict: only alphanumeric before @, domain letters/numbers with dot
  const re = /^[a-zA-Z0-9]+@[a-zA-Z0-9-]+\.[a-zA-Z]{2,}$/;
  return re.test(email);
}

async function validateEmailDNS(email) {
  const domain = email.split('@')[1];
  if (!domain) return false;
  try {
    const res = await fetch(`https://dns.google/resolve?name=${domain}&type=MX`);
    const data = await res.json();
    return (data.Answer && data.Answer.length > 0);
  } catch (err) {
    console.error("DNS lookup failed", err);
    return false;
  }
}

// Get email + pay button
const emailInput = document.getElementById('email');
const payBtn = document.getElementById('pay');

// Add inline error span
const errorMsg = document.createElement("div");
errorMsg.style.color = "red";
errorMsg.style.fontSize = "14px";
emailInput.insertAdjacentElement("afterend", errorMsg);

// Live validation on typing
emailInput.addEventListener("input", async () => {
  const email = emailInput.value.trim();

  if (!validateEmailFormat(email)) {
    errorMsg.textContent = "‚ùå Invalid format. Only letters & numbers before @ allowed.";
    payBtn.disabled = true;
    return;
  }

  const dnsOk = await validateEmailDNS(email);
  if (!dnsOk) {
    errorMsg.textContent = "‚ö†Ô∏è Domain has no valid mail server.";
    payBtn.disabled = true;
    return;
  }

  // All good ‚úÖ
  errorMsg.textContent = "";
  payBtn.disabled = false;
});

// Ensure Pay button starts disabled until valid email entered
payBtn.disabled = true;

 </script>
</body>
</html>
